{% load staticfiles %}<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <title>K线图</title>    <script type="application/javascript" src="{% static 'js/jquery-1.11.2.min.js' %}"></script>    <script type="application/javascript" src="{% static 'js/echarts.js' %}"></script></head><body style="height:100%"><div id="right-container" style="height:100%;"></div></body></html><script>    $(function () {        var app = echarts.init(document.getElementById('right-container'));        app.showLoading({            text: '努力加载中请稍后'        });        app.title = '';        k_line_day_data = {{ day|safe }};        k_line_5min_data = {{ min5|safe }};        k_line_15min_data = {{ min15|safe }};        k_line_30min_data = {{ min30|safe }};        k_line_60min_data = {{ min60|safe }};        set_k_line_option = function (data) {            dates = data['index'].reverse();            datas = data['data'].map(function (item) {                {#                    [open, close, lowest, highest] （即：[开盘值, 收盘值, 最低值, 最高值]）#}                return [+item[0], +item[2], +item[3], +item[1], +item[4], +item[5], +item[6], +item[7], +item[8], +item[9]];            }).reverse();            ma5_datas = datas.map(function (item) {                return +item[7];            });            ma10_datas = datas.map(function (item) {                return +item[8];            });            ma20_datas = datas.map(function (item) {                return +item[9];            });            app.setOption({                xAxis: {                    data: dates                },                series: [                    {                        type: 'candlestick',                        name: '日K',                        data: datas,                        itemStyle: {                            normal: {                                color: '#FD1050',                                color0: '#0CF49B',                                borderColor: '#FD1050',                                borderColor0: '#0CF49B'                            }                        }                    },                    {                        type: 'candlestick',                        name: '5分钟',                        data: datas,                        itemStyle: {                            normal: {                                color: '#FD1050',                                color0: '#0CF49B',                                borderColor: '#FD1050',                                borderColor0: '#0CF49B'                            }                        }                    },                    {                        type: 'candlestick',                        name: '15分钟',                        data: datas,                        itemStyle: {                            normal: {                                color: '#FD1050',                                color0: '#0CF49B',                                borderColor: '#FD1050',                                borderColor0: '#0CF49B'                            }                        }                    },                    {                        type: 'candlestick',                        name: '30分钟',                        data: datas,                        itemStyle: {                            normal: {                                color: '#FD1050',                                color0: '#0CF49B',                                borderColor: '#FD1050',                                borderColor0: '#0CF49B'                            }                        }                    },                    {                        type: 'candlestick',                        name: '60分钟',                        data: datas,                        itemStyle: {                            normal: {                                color: '#FD1050',                                color0: '#0CF49B',                                borderColor: '#FD1050',                                borderColor0: '#0CF49B'                            }                        }                    },                    {                        type: 'line',                        name: 'MA5',                        data: ma5_datas,                        smooth: true,                        showSymbol: false,                        lineStyle: {                            normal: {                                width: 1                            }                        }                    },                    {                        name: 'MA10',                        type: 'line',                        data: ma10_datas,                        smooth: true,                        showSymbol: false,                        lineStyle: {                            normal: {                                width: 1                            }                        }                    },                    {                        name: 'MA20',                        type: 'line',                        data: ma20_datas,                        smooth: true,                        showSymbol: false,                        lineStyle: {                            normal: {                                width: 1                            }                        }                    }                ],                tooltip: {                    formatter: function (params) {                        var res = params[0].seriesName + ' ' + params[0].name;                        res += '<br/>  开盘价 : ' + params[0].value[0] + '  最高价 : ' + params[0].value[3];                        res += '<br/>  收盘价 : ' + params[0].value[1] + '  最低价 : ' + params[0].value[2];                        res += '<br/>  成交量 : ' + params[0].value[4] + '  涨跌幅 : ' + params[0].value[6];                        res += '<br/>  价格变动 : ' + params[0].value[5];                        return res;                    }                }            });            app.hideLoading();        };        app.setOption({            backgroundColor: '#21202D',            legend: {                data: ['日K', '5分钟', '15分钟', '30分钟', '60分钟', 'MA5', 'MA10', 'MA20'],                inactiveColor: '#777',                textStyle: {                    color: '#fff'                },                selected: {                    '5分钟': false,                    '日K': true,                    '15分钟': false,                    '30分钟': false,                    '60分钟': false                }            },            tooltip: {                trigger: 'axis',                axisPointer: {                    animation: false,                    lineStyle: {                        color: '#376df4',                        width: 2,                        opacity: 1                    }                }            },            xAxis: {                type: 'category',                data: [],                axisLine: {lineStyle: {color: '#8392A5'}}            },            yAxis: {                scale: true,                axisLine: {lineStyle: {color: '#8392A5'}},                splitLine: {show: false}            },            dataZoom: [{                textStyle: {                    color: '#8392A5'                },                handleIcon: 'M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z',                handleSize: '80%',                dataBackground: {                    areaStyle: {                        color: '#8392A5'                    },                    lineStyle: {                        opacity: 0.8,                        color: '#8392A5'                    }                },                handleStyle: {                    color: '#fff',                    shadowBlur: 3,                    shadowColor: 'rgba(0, 0, 0, 0.6)',                    shadowOffsetX: 2,                    shadowOffsetY: 2                }            }, {                type: 'inside'            }],            animation: false,            series: [                {                    type: 'candlestick',                    name: '日K',                    data: [],                    itemStyle: {                        normal: {                            color: '#FD1050',                            color0: '#0CF49B',                            borderColor: '#FD1050',                            borderColor0: '#0CF49B'                        }                    }                }            ]        });        set_k_line_option(k_line_day_data);        app.on('legendselectchanged', function (params) {            params['selected']['日K'] = false;            params['selected']['5分钟'] = false;            params['selected']['15分钟'] = false;            params['selected']['30分钟'] = false;            params['selected']['60分钟'] = false;            {#            || params['name'] == '日K'#}            name = params['name'];            params['selected'][name] = true;            type_num = params['name'].replace('分钟', '');            if (params['name'].indexOf('分钟') != -1 || params['name'] == '日K') {                app.setOption({                    legend: {                        data: ['日K', '5分钟', '15分钟', '30分钟', '60分钟', 'MA5', 'MA10', 'MA20'],                        inactiveColor: '#777',                        textStyle: {                            color: '#fff'                        },                        selected: params['selected']                    }                });            }            if (params['name'].indexOf('分钟') != -1) {                if (type_num == 5) {                    set_k_line_option(k_line_5min_data)                }                if (type_num == 15) {                    set_k_line_option(k_line_15min_data)                }                if (type_num == 30) {                    set_k_line_option(k_line_30min_data)                }                if (type_num == 60) {                    set_k_line_option(k_line_60min_data)                }            } else if (params['name'] == '日K') {                set_k_line_option(k_line_day_data)            }        });    })    $(window).resize(function () {        app.resize();    });</script>